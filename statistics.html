<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Statistics - Student Performance Report</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Navigation Header -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <span class="logo-icon">üìä</span>
                <span class="logo-text">Student Performance Report</span>
            </div>
            <div class="nav-menu">
                <a href="index.html" class="nav-link">Home</a>
                <a href="dashboard.html" class="nav-link">Dashboard</a>
                <a href="records.html" class="nav-link">Records</a>
                <a href="statistics.html" class="nav-link active">Statistics</a>
            </div>
        </div>
    </nav>

    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="header-top">
                <div class="header-left">
                    <div class="header-icon">üìà</div>
                    <div class="header-titles">
                        <h1>Statistics & Analytics</h1>
                        <p class="subtitle">Performance insights and data analysis</p>
                    </div>
                </div>
                <div class="header-right">
                    <div class="header-info">
                        <div class="info-item">
                            <span class="info-label">Data Points:</span>
                            <span class="info-value" id="dataPoints">0</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Analysis Date:</span>
                            <span class="info-value" id="analysisDate">Today</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="header-stats">
                <div class="header-stat">
                    <span class="stat-icon">üë•</span>
                    <div class="stat-content">
                        <p class="stat-label">Total Students</p>
                        <p class="stat-number" id="statTotalStudents">0</p>
                    </div>
                </div>
                <div class="header-stat">
                    <span class="stat-icon">‚≠ê</span>
                    <div class="stat-content">
                        <p class="stat-label">Avg Marks</p>
                        <p class="stat-number" id="statAvgMarks">0.00</p>
                    </div>
                </div>
                <div class="header-stat">
                    <span class="stat-icon">üèÜ</span>
                    <div class="stat-content">
                        <p class="stat-label">Highest Score</p>
                        <p class="stat-number" id="statHighestMarks">0</p>
                    </div>
                </div>
                <div class="header-stat">
                    <span class="stat-icon">üìä</span>
                    <div class="stat-content">
                        <p class="stat-label">Lowest Score</p>
                        <p class="stat-number" id="statLowestMarks">0</p>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <div class="content-wrapper">
            <!-- Performance Statistics Section -->
            <section class="stats-section">
                <h2 class="section-title">Performance Overview</h2>
                <div class="stats-grid">
                    <div class="stat-card">
                        <h3>Total Students</h3>
                        <p class="stat-value" id="totalStudents">0</p>
                    </div>
                    <div class="stat-card">
                        <h3>Average Marks</h3>
                        <p class="stat-value" id="avgMarks">0.00</p>
                    </div>
                    <div class="stat-card">
                        <h3>Highest Marks</h3>
                        <p class="stat-value" id="highestMarks">0</p>
                    </div>
                    <div class="stat-card">
                        <h3>Lowest Marks</h3>
                        <p class="stat-value" id="lowestMarks">0</p>
                    </div>
                </div>
            </section>

            <!-- Grade Distribution Section -->
            <section class="grade-distribution">
                <h2 class="section-title">Grade Distribution</h2>
                <div class="grade-grid">
                    <div class="grade-item">
                        <div class="grade-header">
                            <span class="grade-label">A+ (90-100)</span>
                            <span class="grade-count" id="countA">0</span>
                        </div>
                        <div class="grade-bar">
                            <div class="grade-fill" id="barA" style="width: 0%"></div>
                        </div>
                    </div>
                    <div class="grade-item">
                        <div class="grade-header">
                            <span class="grade-label">A (80-89)</span>
                            <span class="grade-count" id="countAMinus">0</span>
                        </div>
                        <div class="grade-bar">
                            <div class="grade-fill" id="barAMinus" style="width: 0%"></div>
                        </div>
                    </div>
                    <div class="grade-item">
                        <div class="grade-header">
                            <span class="grade-label">B+ (70-79)</span>
                            <span class="grade-count" id="countBPlus">0</span>
                        </div>
                        <div class="grade-bar">
                            <div class="grade-fill" id="barBPlus" style="width: 0%"></div>
                        </div>
                    </div>
                    <div class="grade-item">
                        <div class="grade-header">
                            <span class="grade-label">B (60-69)</span>
                            <span class="grade-count" id="countB">0</span>
                        </div>
                        <div class="grade-bar">
                            <div class="grade-fill" id="barB" style="width: 0%"></div>
                        </div>
                    </div>
                    <div class="grade-item">
                        <div class="grade-header">
                            <span class="grade-label">C (50-59)</span>
                            <span class="grade-count" id="countC">0</span>
                        </div>
                        <div class="grade-bar">
                            <div class="grade-fill" id="barC" style="width: 0%"></div>
                        </div>
                    </div>
                    <div class="grade-item">
                        <div class="grade-header">
                            <span class="grade-label">F (Below 50)</span>
                            <span class="grade-count" id="countF">0</span>
                        </div>
                        <div class="grade-bar">
                            <div class="grade-fill" id="barF" style="width: 0%"></div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Subject Performance Section -->
            <section class="subject-performance">
                <h2 class="section-title">Performance by Subject</h2>
                <div class="subject-grid" id="subjectGrid">
                    <div class="empty-row">No data available. Add student records to see subject performance.</div>
                </div>
            </section>

            <!-- Pass/Fail Statistics -->
            <section class="pass-fail-section">
                <h2 class="section-title">Pass/Fail Statistics</h2>
                <div class="pass-fail-container">
                    <div class="pass-fail-card pass-card">
                        <h3>Passed</h3>
                        <div class="pass-fail-number" id="passedCount">0</div>
                        <div class="pass-fail-percentage" id="passPercentage">0%</div>
                    </div>
                    <div class="pass-fail-card fail-card">
                        <h3>Failed</h3>
                        <div class="pass-fail-number" id="failedCount">0</div>
                        <div class="pass-fail-percentage" id="failPercentage">0%</div>
                    </div>
                </div>
            </section>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="toast"></div>

    <script src="data.js"></script>
    <script src="script.js"></script>
    <script>
        // Load and display statistics on page load
        document.addEventListener('DOMContentLoaded', () => {
            loadData();
            updateAllStatistics();
        });

        function updateAllStatistics() {
            updateBasicStatistics();
            updateGradeDistribution();
            updateSubjectPerformance();
            updatePassFailStatistics();
        }

        function updateBasicStatistics() {
            if (students.length === 0) {
                document.getElementById('totalStudents').textContent = '0';
                document.getElementById('avgMarks').textContent = '0.00';
                document.getElementById('highestMarks').textContent = '0';
                document.getElementById('lowestMarks').textContent = '0';
                document.getElementById('statTotalStudents').textContent = '0';
                document.getElementById('statAvgMarks').textContent = '0.00';
                document.getElementById('statHighestMarks').textContent = '0';
                document.getElementById('statLowestMarks').textContent = '0';
                document.getElementById('dataPoints').textContent = '0';
                return;
            }

            const marks = students.map(s => s.marks);
            const total = marks.length;
            const avg = (marks.reduce((a, b) => a + b, 0) / total).toFixed(2);
            const highest = Math.max(...marks);
            const lowest = Math.min(...marks);

            document.getElementById('totalStudents').textContent = total;
            document.getElementById('avgMarks').textContent = avg;
            document.getElementById('highestMarks').textContent = highest;
            document.getElementById('lowestMarks').textContent = lowest;
            document.getElementById('statTotalStudents').textContent = total;
            document.getElementById('statAvgMarks').textContent = avg;
            document.getElementById('statHighestMarks').textContent = highest;
            document.getElementById('statLowestMarks').textContent = lowest;
            document.getElementById('dataPoints').textContent = total;
        }

        function updateGradeDistribution() {
            const gradeCount = {
                'A+': 0,
                'A': 0,
                'B+': 0,
                'B': 0,
                'C': 0,
                'F': 0
            };

            students.forEach(s => {
                if (gradeCount.hasOwnProperty(s.grade)) {
                    gradeCount[s.grade]++;
                }
            });

            const total = students.length || 1;
            document.getElementById('countA').textContent = gradeCount['A+'];
            document.getElementById('barA').style.width = (gradeCount['A+'] / total) * 100 + '%';

            document.getElementById('countAMinus').textContent = gradeCount['A'];
            document.getElementById('barAMinus').style.width = (gradeCount['A'] / total) * 100 + '%';

            document.getElementById('countBPlus').textContent = gradeCount['B+'];
            document.getElementById('barBPlus').style.width = (gradeCount['B+'] / total) * 100 + '%';

            document.getElementById('countB').textContent = gradeCount['B'];
            document.getElementById('barB').style.width = (gradeCount['B'] / total) * 100 + '%';

            document.getElementById('countC').textContent = gradeCount['C'];
            document.getElementById('barC').style.width = (gradeCount['C'] / total) * 100 + '%';

            document.getElementById('countF').textContent = gradeCount['F'];
            document.getElementById('barF').style.width = (gradeCount['F'] / total) * 100 + '%';
        }

        function updateSubjectPerformance() {
            const subjectData = {};

            students.forEach(s => {
                if (!subjectData[s.subject]) {
                    subjectData[s.subject] = {
                        total: 0,
                        sum: 0,
                        count: 0
                    };
                }
                subjectData[s.subject].sum += s.marks;
                subjectData[s.subject].count++;
            });

            const subjectGrid = document.getElementById('subjectGrid');

            if (Object.keys(subjectData).length === 0) {
                subjectGrid.innerHTML = '<div class="empty-row">No data available. Add student records to see subject performance.</div>';
                return;
            }

            subjectGrid.innerHTML = Object.entries(subjectData).map(([subject, data]) => {
                const avg = (data.sum / data.count).toFixed(2);
                return `
                    <div class="subject-item">
                        <h4>${subject}</h4>
                        <p class="subject-stat">Avg: <strong>${avg}</strong></p>
                        <p class="subject-stat">Students: <strong>${data.count}</strong></p>
                    </div>
                `;
            }).join('');
        }

        function updatePassFailStatistics() {
            if (students.length === 0) {
                document.getElementById('passedCount').textContent = '0';
                document.getElementById('failedCount').textContent = '0';
                document.getElementById('passPercentage').textContent = '0%';
                document.getElementById('failPercentage').textContent = '0%';
                return;
            }

            const passed = students.filter(s => s.marks >= 50).length;
            const failed = students.length - passed;
            const passPercentage = Math.round((passed / students.length) * 100);
            const failPercentage = 100 - passPercentage;

            document.getElementById('passedCount').textContent = passed;
            document.getElementById('failedCount').textContent = failed;
            document.getElementById('passPercentage').textContent = passPercentage + '%';
            document.getElementById('failPercentage').textContent = failPercentage + '%';
        }
    </script>
</body>
</html>
